-- MySQL Script generated by MySQL Workbench
-- mar 10 nov 2020 23:13:43
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`Persona`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Persona` (
  `DNI` VARCHAR(9) NOT NULL,
  `Nombre` VARCHAR(45) NOT NULL,
  `Apellidos` VARCHAR(90) NOT NULL,
  `Fecha_de_nacimiento` DATE NOT NULL,
  `DNI_cabeza` VARCHAR(9) NOT NULL,
  PRIMARY KEY (`DNI`),
  INDEX `Persona_idx` (`DNI_cabeza` ASC) VISIBLE,
  CONSTRAINT `Persona`
    FOREIGN KEY (`DNI_cabeza`)
    REFERENCES `mydb`.`Persona` (`DNI`)
    ON DELETE RESTRICT
    ON UPDATE RESTRICT)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Zona`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Zona` (
  `Nombre` VARCHAR(45) NOT NULL,
  `Concejal` VARCHAR(45) NULL,
  `Ubicación` VARCHAR(45) NOT NULL,
  `Municipio` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`Nombre`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Bloque`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Bloque` (
  `Calle` VARCHAR(70) NOT NULL,
  `Numero` INT NOT NULL,
  `Cantidad_personas` INT GENERATED ALWAYS AS (),
  `Nombre_zona` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`Calle`, `Numero`),
  INDEX `Nombre_zona_idx` (`Nombre_zona` ASC) VISIBLE,
  CONSTRAINT `Nombre_zona`
    FOREIGN KEY (`Nombre_zona`)
    REFERENCES `mydb`.`Zona` (`Nombre`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Piso`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Piso` (
  `Calle` VARCHAR(70) NOT NULL,
  `Numero` INT NOT NULL,
  `Planta` INT NOT NULL,
  `Letra` VARCHAR(1) NOT NULL,
  `Portal` VARCHAR(45) NOT NULL,
  `Cantidad_personas` INT GENERATED ALWAYS AS (),
  `Tamaño` INT NULL,
  `DNI_dueño` VARCHAR(9) NOT NULL,
  PRIMARY KEY (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`),
  INDEX `Dueño_idx` (`DNI_dueño` ASC) VISIBLE,
  INDEX `index3` () VISIBLE,
  CONSTRAINT `Bloque`
    FOREIGN KEY (`Calle` , `Numero`)
    REFERENCES `mydb`.`Bloque` (`Calle` , `Numero`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Dueño`
    FOREIGN KEY (`DNI_dueño`)
    REFERENCES `mydb`.`Persona` (`DNI`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ViviendasUNIF`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ViviendasUNIF` (
  `Calle` VARCHAR(70) NOT NULL,
  `Numero` INT NOT NULL,
  `Cantidad_personas` INT NOT NULL,
  `Tamaño` INT NULL,
  `Nombre_zona` VARCHAR(45) NOT NULL,
  `DNI_dueño` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`Calle`, `Numero`),
  INDEX `Bloque_idx` (`Nombre_zona` ASC) VISIBLE,
  INDEX `Dueño_idx` (`DNI_dueño` ASC) VISIBLE,
  CONSTRAINT `Bloque`
    FOREIGN KEY (`Nombre_zona`)
    REFERENCES `mydb`.`Zona` (`Nombre`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Dueño`
    FOREIGN KEY (`DNI_dueño`)
    REFERENCES `mydb`.`Persona` (`DNI`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ViviendaUNIF_Persona_Vive`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ViviendaUNIF_Persona_Vive` (
  `Calle` VARCHAR(70) NOT NULL,
  `Numero` INT NOT NULL,
  `DNI` VARCHAR(9) NOT NULL,
  PRIMARY KEY (`Calle`, `Numero`, `DNI`),
  INDEX `Persona_idx` (`DNI` ASC) VISIBLE,
  CONSTRAINT `ViviendaUNIF`
    FOREIGN KEY (`Calle` , `Numero`)
    REFERENCES `mydb`.`ViviendasUNIF` (`Calle` , `Numero`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Persona`
    FOREIGN KEY (`DNI`)
    REFERENCES `mydb`.`Persona` (`DNI`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Piso_Persona_Vive`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Piso_Persona_Vive` (
  `Calle` VARCHAR(70) NOT NULL,
  `Numero` INT NOT NULL,
  `Planta` INT NOT NULL,
  `Letra` VARCHAR(1) NOT NULL,
  `Portal` VARCHAR(45) NOT NULL,
  `DNI` VARCHAR(9) NOT NULL,
  PRIMARY KEY (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `DNI`),
  INDEX `Piso_idx` (`Calle` ASC, `Numero` ASC, `Planta` ASC, `Letra` ASC, `Portal` ASC) VISIBLE,
  CONSTRAINT `Persona`
    FOREIGN KEY (`DNI`)
    REFERENCES `mydb`.`Persona` (`DNI`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Piso`
    FOREIGN KEY (`Calle` , `Numero` , `Planta` , `Letra` , `Portal`)
    REFERENCES `mydb`.`Piso` (`Calle` , `Numero` , `Planta` , `Letra` , `Portal`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `mydb`.`Persona`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Persona` (`DNI`, `Nombre`, `Apellidos`, `Fecha_de_nacimiento`, `DNI_cabeza`) VALUES ('12345678A', 'Juan ', 'Gonzales Perez', '12/07/1976', '12345678A');
INSERT INTO `mydb`.`Persona` (`DNI`, `Nombre`, `Apellidos`, `Fecha_de_nacimiento`, `DNI_cabeza`) VALUES ('23456789B', 'Candelaria', 'Rodriguez Garcia', '13/03/1989', '23456789B');
INSERT INTO `mydb`.`Persona` (`DNI`, `Nombre`, `Apellidos`, `Fecha_de_nacimiento`, `DNI_cabeza`) VALUES ('34567891C', 'Kabir', 'Diaz Melguizo', '14/01/2000', '34567891C');
INSERT INTO `mydb`.`Persona` (`DNI`, `Nombre`, `Apellidos`, `Fecha_de_nacimiento`, `DNI_cabeza`) VALUES ('45678912D', 'Carla', 'Cala Herrera', '15/02/2016', '34567891C');
INSERT INTO `mydb`.`Persona` (`DNI`, `Nombre`, `Apellidos`, `Fecha_de_nacimiento`, `DNI_cabeza`) VALUES ('56789123E', 'Javier', 'Figueroa Gil', '16/11/2019', '23456789B');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Zona`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Zona` (`Nombre`, `Concejal`, `Ubicación`, `Municipio`) VALUES ('San Benito', 'Oscar', 'San Benito', 'San Cristóbal de La Laguna');
INSERT INTO `mydb`.`Zona` (`Nombre`, `Concejal`, `Ubicación`, `Municipio`) VALUES ('Las Chumberas', 'Eduardo', 'Las Chumberas', 'San Cristóbal de La Laguna');
INSERT INTO `mydb`.`Zona` (`Nombre`, `Concejal`, `Ubicación`, `Municipio`) VALUES ('Av. La Trinida', 'Diego', 'Av. La Trinida', 'San Cristóbal de La Laguna');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Bloque`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Bloque` (`Calle`, `Numero`, `Cantidad_personas`, `Nombre_zona`) VALUES ('Lucas Fernandez', 12, DEFAULT, 'San Benito');
INSERT INTO `mydb`.`Bloque` (`Calle`, `Numero`, `Cantidad_personas`, `Nombre_zona`) VALUES ('Pedro Gutierres', 56, DEFAULT, 'Las  Chumberas');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Piso`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Piso` (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `Cantidad_personas`, `Tamaño`, `DNI_dueño`) VALUES ('Lucas Fernandez', 12, 3, 'A', '3', DEFAULT, 500, '12345678A');
INSERT INTO `mydb`.`Piso` (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `Cantidad_personas`, `Tamaño`, `DNI_dueño`) VALUES ('Pedro Gutierres ', 56, 6, 'B', '1', DEFAULT, 750, '23456789B');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`ViviendasUNIF`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`ViviendasUNIF` (`Calle`, `Numero`, `Cantidad_personas`, `Tamaño`, `Nombre_zona`, `DNI_dueño`) VALUES ('Barcelona', 12, , 1200, 'Av. La Trinida', '34567891C');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`ViviendaUNIF_Persona_Vive`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`ViviendaUNIF_Persona_Vive` (`Calle`, `Numero`, `DNI`) VALUES ('Barcelona', 12, '12345678A');
INSERT INTO `mydb`.`ViviendaUNIF_Persona_Vive` (`Calle`, `Numero`, `DNI`) VALUES ('Barcelona', 12, '45678912D');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Piso_Persona_Vive`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Piso_Persona_Vive` (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `DNI`) VALUES ('Lucas Fernandez', 12, 3, 'A', '3', '23456789B');
INSERT INTO `mydb`.`Piso_Persona_Vive` (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `DNI`) VALUES ('Pedro Gutierres ', 56, 6, 'B', '1', '34567891C');
INSERT INTO `mydb`.`Piso_Persona_Vive` (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `DNI`) VALUES ('Lucas Fernandez', 12, 3, 'A', '3', '56789123E');

COMMIT;

