-- MySQL Script generated by MySQL Workbench
-- jue 12 nov 2020 17:33:32
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema Catastro
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema Catastro
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `Catastro` ;
USE `Catastro` ;

-- -----------------------------------------------------
-- Table `Catastro`.`Persona`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Catastro`.`Persona` (
  `DNI` VARCHAR(9) NOT NULL,
  `Nombre` VARCHAR(45) NOT NULL,
  `Apellidos` VARCHAR(90) NOT NULL,
  `Fecha_de_nacimiento` DATE NOT NULL,
  `DNI_cabeza` VARCHAR(9) NOT NULL,
  PRIMARY KEY (`DNI`),
  INDEX `Persona_idx` (`DNI_cabeza` ASC),
  CONSTRAINT `Persona`
    FOREIGN KEY (`DNI_cabeza`)
    REFERENCES `Catastro`.`Persona` (`DNI`)
    ON DELETE RESTRICT
    ON UPDATE RESTRICT)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Catastro`.`Zona`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Catastro`.`Zona` (
  `Nombre` VARCHAR(45) NOT NULL,
  `Concejal` VARCHAR(45) NULL,
  `Ubicación` VARCHAR(45) NOT NULL,
  `Municipio` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`Nombre`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Catastro`.`Bloque`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Catastro`.`Bloque` (
  `Calle` VARCHAR(70) NOT NULL,
  `Numero` INT NOT NULL,
  `Cantidad_personas` INT NULL,
  `Nombre_zona` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`Calle`, `Numero`),
  INDEX `Nombre_zona_idx` (`Nombre_zona` ASC),
  CONSTRAINT `Nombre_zona`
    FOREIGN KEY (`Nombre_zona`)
    REFERENCES `Catastro`.`Zona` (`Nombre`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Catastro`.`ViviendaUNIF`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Catastro`.`ViviendaUNIF` (
  `Calle` VARCHAR(70) NOT NULL,
  `Numero` INT NOT NULL,
  `Cantidad_personas` INT NULL,
  `Tamaño` INT NULL,
  `Nombre_zona` VARCHAR(45) NOT NULL,
  `DNI_dueño` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`Calle`, `Numero`),
  INDEX `Bloque_idx` (`Nombre_zona` ASC),
  INDEX `Dueño_idx` (`DNI_dueño` ASC),
  CONSTRAINT `Zona`
    FOREIGN KEY (`Nombre_zona`)
    REFERENCES `Catastro`.`Zona` (`Nombre`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Dueño_Vivienda`
    FOREIGN KEY (`DNI_dueño`)
    REFERENCES `Catastro`.`Persona` (`DNI`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Catastro`.`ViviendaUNIF_Persona_Vive`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Catastro`.`ViviendaUNIF_Persona_Vive` (
  `Calle` VARCHAR(70) NOT NULL,
  `Numero` INT NOT NULL,
  `DNI` VARCHAR(9) NOT NULL,
  PRIMARY KEY (`Calle`, `Numero`, `DNI`),
  INDEX `Persona_idx` (`DNI` ASC),
  INDEX `ViviendaUNIF_idx` (`Calle` ASC, `Numero` ASC),
  CONSTRAINT `ViviendaUNIF_Vive`
    FOREIGN KEY (`Calle` , `Numero`)
    REFERENCES `Catastro`.`ViviendaUNIF` (`Calle` , `Numero`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Persona_Vive_Vivienda`
    FOREIGN KEY (`DNI`)
    REFERENCES `Catastro`.`Persona` (`DNI`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Catastro`.`Piso`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Catastro`.`Piso` (
  `Calle` VARCHAR(70) NOT NULL,
  `Numero` INT NOT NULL,
  `Planta` INT NOT NULL,
  `Letra` VARCHAR(1) NOT NULL,
  `Portal` VARCHAR(45) NOT NULL,
  `Cantidad_personas` INT NULL,
  `Tamaño` INT NULL,
  `DNI_Dueño` VARCHAR(9) NOT NULL,
  PRIMARY KEY (`Calle`, `Planta`, `Numero`, `Letra`, `Portal`),
  INDEX `Bloque_idx` (`Calle` ASC, `Numero` ASC),
  INDEX `Dueño_idx` (`DNI_Dueño` ASC),
  CONSTRAINT `Bloque_Piso`
    FOREIGN KEY (`Calle` , `Numero`)
    REFERENCES `Catastro`.`Bloque` (`Calle` , `Numero`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Dueño_Piso`
    FOREIGN KEY (`DNI_Dueño`)
    REFERENCES `Catastro`.`Persona` (`DNI`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Catastro`.`Piso_Persona_Vive`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `Catastro`.`Piso_Persona_Vive` (
  `Calle` VARCHAR(70) NOT NULL,
  `Numero` INT NOT NULL,
  `Planta` INT NOT NULL,
  `Letra` VARCHAR(1) NOT NULL,
  `Portal` VARCHAR(45) NOT NULL,
  `DNI` VARCHAR(9) NOT NULL,
  PRIMARY KEY (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `DNI`),
  INDEX `Persona_idx` (`DNI` ASC),
  INDEX `Piso_idx` (`Calle` ASC, `Numero` ASC, `Planta` ASC, `Letra` ASC, `Portal` ASC),
  CONSTRAINT `Piso_vive`
    FOREIGN KEY (`Calle` , `Numero` , `Planta` , `Letra` , `Portal`)
    REFERENCES `Catastro`.`Piso` (`Calle` , `Numero` , `Planta` , `Letra` , `Portal`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Persona_vive_piso`
    FOREIGN KEY (`DNI`)
    REFERENCES `Catastro`.`Persona` (`DNI`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `Catastro`.`Persona`
-- -----------------------------------------------------
START TRANSACTION;
USE `Catastro`;
INSERT INTO `Catastro`.`Persona` (`DNI`, `Nombre`, `Apellidos`, `Fecha_de_nacimiento`, `DNI_cabeza`) VALUES ('12345678A', 'Juan ', 'Gonzales Perez', '1976-12-07', '12345678A');
INSERT INTO `Catastro`.`Persona` (`DNI`, `Nombre`, `Apellidos`, `Fecha_de_nacimiento`, `DNI_cabeza`) VALUES ('23456789B', 'Candelaria', 'Rodriguez Garcia', '1989-03-13', '23456789B');
INSERT INTO `Catastro`.`Persona` (`DNI`, `Nombre`, `Apellidos`, `Fecha_de_nacimiento`, `DNI_cabeza`) VALUES ('34567891C', 'Kabir', 'Diaz Melguizo', '2000-01-14', '34567891C');
INSERT INTO `Catastro`.`Persona` (`DNI`, `Nombre`, `Apellidos`, `Fecha_de_nacimiento`, `DNI_cabeza`) VALUES ('45678912D', 'Carla', 'Cala Herrera', '2016-02-15', '34567891C');
INSERT INTO `Catastro`.`Persona` (`DNI`, `Nombre`, `Apellidos`, `Fecha_de_nacimiento`, `DNI_cabeza`) VALUES ('56789123E', 'Javier', 'Figueroa Gil', '2019-11-16', '23456789B');

COMMIT;


-- -----------------------------------------------------
-- Data for table `Catastro`.`Zona`
-- -----------------------------------------------------
START TRANSACTION;
USE `Catastro`;
INSERT INTO `Catastro`.`Zona` (`Nombre`, `Concejal`, `Ubicación`, `Municipio`) VALUES ('San Benito', 'Oscar', 'San Benito', 'San Cristóbal de La Laguna');
INSERT INTO `Catastro`.`Zona` (`Nombre`, `Concejal`, `Ubicación`, `Municipio`) VALUES ('Las Chumberas', 'Eduardo', 'Las Chumberas', 'San Cristóbal de La Laguna');
INSERT INTO `Catastro`.`Zona` (`Nombre`, `Concejal`, `Ubicación`, `Municipio`) VALUES ('Av. La Trinida', 'Diego', 'Av. La Trinida', 'San Cristóbal de La Laguna');

COMMIT;


-- -----------------------------------------------------
-- Data for table `Catastro`.`Bloque`
-- -----------------------------------------------------
START TRANSACTION;
USE `Catastro`;
INSERT INTO `Catastro`.`Bloque` (`Calle`, `Numero`, `Cantidad_personas`, `Nombre_zona`) VALUES ('Lucas Fernandez', 12, 0, 'San Benito');
INSERT INTO `Catastro`.`Bloque` (`Calle`, `Numero`, `Cantidad_personas`, `Nombre_zona`) VALUES ('Pedro Gutierres', 56, 0, 'Las Chumberas');

COMMIT;
-- -----------------------------------------------------
-- Data for table `Catastro`.`Piso`
-- -----------------------------------------------------
START TRANSACTION;
USE `Catastro`;
INSERT INTO `Catastro`.`Piso` (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `Cantidad_personas`, `Tamaño`, `DNI_dueño`) VALUES ('Lucas Fernandez', 12, 3, 'A', '3', 0, 500, '12345678A');
INSERT INTO `Catastro`.`Piso` (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `Cantidad_personas`, `Tamaño`, `DNI_dueño`) VALUES ('Pedro Gutierres ', 56, 6, 'B', '1', 0, 750, '23456789B');

COMMIT;

-- -----------------------------------------------------
-- Data for table `Catastro`.`ViviendaUNIF`
-- -----------------------------------------------------
START TRANSACTION;
USE `Catastro`;
INSERT INTO `Catastro`.`ViviendaUNIF` (`Calle`, `Numero`, `Cantidad_personas`, `Tamaño`, `Nombre_zona`, `DNI_dueño`) VALUES ('Barcelona', 12, 0, 1200, 'Av. La Trinida', '34567891C');

COMMIT;


-- -----------------------------------------------------
-- Data for table `Catastro`.`ViviendaUNIF_Persona_Vive`
-- -----------------------------------------------------
START TRANSACTION;
USE `Catastro`;
INSERT INTO `Catastro`.`ViviendaUNIF_Persona_Vive` (`Calle`, `Numero`, `DNI`) VALUES ('Barcelona', 12, '12345678A');
INSERT INTO `Catastro`.`ViviendaUNIF_Persona_Vive` (`Calle`, `Numero`, `DNI`) VALUES ('Barcelona', 12, '45678912D');

COMMIT;
-- -----------------------------------------------------
-- Data for table `Catastro`.`Piso_Persona_Vive`
-- -----------------------------------------------------
START TRANSACTION;
USE `Catastro`;
INSERT INTO `Catastro`.`Piso_Persona_Vive` (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `DNI`) VALUES ('Lucas Fernandez', 12, 3, 'A', '3', '23456789B');
INSERT INTO `Catastro`.`Piso_Persona_Vive` (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `DNI`) VALUES ('Pedro Gutierres ', 56, 6, 'B', '1', '34567891C');
INSERT INTO `Catastro`.`Piso_Persona_Vive` (`Calle`, `Numero`, `Planta`, `Letra`, `Portal`, `DNI`) VALUES ('Lucas Fernandez', 12, 3, 'A', '3', '56789123E');

COMMIT;
